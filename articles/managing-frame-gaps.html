<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="pathviewr">
<title>Managing frame gaps with pathviewr • pathviewr</title>
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="/apple-touch-icon.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://docs.ropensci.org/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Managing frame gaps with pathviewr">
<meta property="og:description" content="pathviewr">
<meta property="og:image" content="https://docs.ropensci.org/pathviewr/logo.png">
<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Matomo --><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/cookieconsent@3/build/cookieconsent.min.css">
<script src="https://cdn.jsdelivr.net/npm/cookieconsent@3/build/cookieconsent.min.js" data-cfasync="false"></script><script src="https://ropensci.org/scripts/matomo.js"></script><noscript><p><img src="https://ropensci.matomo.cloud/matomo.php?idsite=1&amp;rec=1" style="border:0;" alt=""></p></noscript>
<!-- End Matomo Code -->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    <a href="https://ropensci.org" class="external-link"><img src="https://ropensci.org/img/icon_short_white.svg" id="hexlogo" alt="rOpenSci"></a>
    <a class="navbar-brand me-2" href="../index.html">pathviewr</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">1.1.7</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"></ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-vignettes">Vignettes</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-vignettes">
    <a class="dropdown-item" href="../articles/data-import-cleaning.html">Basics of data import and cleaning in pathviewr</a>
    <a class="dropdown-item" href="../articles/managing-frame-gaps.html">Managing frame gaps with pathviewr</a>
    <a class="dropdown-item" href="../articles/visual-perception-functions.html">Estimating visual perceptions from tracking data</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/ropensci/pathviewr/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Managing frame gaps with pathviewr</h1>
                        <h4 data-toc-skip class="author">Melissa S. Armstrong</h4>
            
            <h4 data-toc-skip class="date">2024-03-02</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/ropensci/pathviewr/blob/HEAD/vignettes/managing-frame-gaps.Rmd" class="external-link"><code>vignettes/managing-frame-gaps.Rmd</code></a></small>
      <div class="d-none name"><code>managing-frame-gaps.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="defining-trajectories-with-pathviewr">Defining trajectories with <code>pathviewr</code><a class="anchor" aria-label="anchor" href="#defining-trajectories-with-pathviewr"></a>
</h2>
<p><code>pathviewr</code> defines trajectories as continuous movement from one side of a region of interest to the other. Before trajectories can be defined, the region of interest must be selected via <code><a href="../reference/select_x_percent.html">select_x_percent()</a></code> in addition to all the previous steps of the data import and cleaning pipeline as described in <a href="https://docs.ropensci.org/pathviewr/articles/data-import-cleaning.html">the Data Import and Cleaning vignette</a>. We’ll start with loading <code>pathviewr</code> and a few packages from the <code>tidyverse</code> and importing our data.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## If you do not already have pathviewr installed:</span></span>
<span><span class="co"># install.packages("devtools")</span></span>
<span><span class="co"># devtools::install_github("ropensci/pathviewr")</span></span>
<span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://docs.ropensci.org/pathviewr">pathviewr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://magrittr.tidyverse.org" class="external-link">magrittr</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Import the example Motive data included in </span></span>
<span><span class="co">## the package</span></span>
<span><span class="va">motive_data</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="../reference/read_motive_csv.html">read_motive_csv</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"pathviewr_motive_example_data.csv"</span>,</span>
<span>                package <span class="op">=</span> <span class="st">'pathviewr'</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p>We’ll quickly run through the cleanup pipeline using one of <code>pathviewr</code>’s all-in-one cleaning functions as described in <a href="https://docs.ropensci.org/pathviewr/articles/data-import-cleaning.html">the Data Import and Cleaning vignette</a>. Since trajectories are defined in the <code><a href="../reference/separate_trajectories.html">separate_trajectories()</a></code> function, we’ll stop the all-in-one there by setting it and every step after it to <code>FALSE</code> so we can take a closer look at how trajectories are defined. Since all steps are set to <code>TRUE</code> by default, we don’t actually need to list them in the function, just those we want to switch to <code>FALSE</code> or those that require additional arguments.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">motive_cleaned</span> <span class="op">&lt;-</span></span>
<span>  <span class="va">motive_data</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/clean_viewr.html">clean_viewr</a></span><span class="op">(</span></span>
<span>    desired_percent <span class="op">=</span> <span class="fl">70</span>,</span>
<span>    rename_viewr_characters <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    separate_trajectories <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    get_full_trajectories <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="co">## Quick plot</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">motive_cleaned</span><span class="op">$</span><span class="va">position_length</span>,</span>
<span>     <span class="va">motive_cleaned</span><span class="op">$</span><span class="va">position_width</span>,</span>
<span>     asp <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<p><img src="managing-frame-gaps_files/figure-html/cleanup_data-1.png" width="700"></p>
<div class="section level3">
<h3 id="inspecting-the-data">Inspecting the data<a class="anchor" aria-label="anchor" href="#inspecting-the-data"></a>
</h3>
<p>We’ve cleaned up our data and are ready to link individual data points into continuous trajectories. Deciding exactly how to define a trajectory will depend largely on the quality of data collected and the resolution required to answer a given question about the data. If the data are fairly continuous and high resolution is required, the default <code>max_frame_gap = 1</code> will not allow any frame gaps–movement must be continuous.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">motive_mfg1</span> <span class="op">&lt;-</span> </span>
<span>  <span class="va">motive_cleaned</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="../reference/separate_trajectories.html">separate_trajectories</a></span><span class="op">(</span></span>
<span>    max_frame_gap <span class="op">=</span> <span class="fl">1</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="co">## Quick plot</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">motive_mfg1</span><span class="op">$</span><span class="va">position_length</span>,</span>
<span>     <span class="va">motive_mfg1</span><span class="op">$</span><span class="va">position_width</span>,</span>
<span>     asp <span class="op">=</span> <span class="fl">1</span>, col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">motive_mfg1</span><span class="op">$</span><span class="va">file_sub_traj</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="managing-frame-gaps_files/figure-html/max_frame_gap_1-1.png" width="700"></p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co">## How many trajectories do we end up with?</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">motive_mfg1</span><span class="op">$</span><span class="va">file_sub_traj</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 16</span></span></code></pre></div>
<p>Plotting each trajectory reveals that perhaps some trajectories that should be continuous have been split into two or more separate trajectories because of a dropped frame or two. This data may require relaxing the stringent no-frame-gaps requirement in order to link data points that should go together into a single trajectory. Let’s try setting <code>max_frame_gap = 5</code>.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">motive_mfg5</span> <span class="op">&lt;-</span> </span>
<span>  <span class="va">motive_cleaned</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="../reference/separate_trajectories.html">separate_trajectories</a></span><span class="op">(</span></span>
<span>    max_frame_gap <span class="op">=</span> <span class="fl">5</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="co">## Quick plot</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">motive_mfg5</span><span class="op">$</span><span class="va">position_length</span>,</span>
<span>     <span class="va">motive_mfg5</span><span class="op">$</span><span class="va">position_width</span>,</span>
<span>     asp <span class="op">=</span> <span class="fl">1</span>, col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">motive_mfg5</span><span class="op">$</span><span class="va">file_sub_traj</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="managing-frame-gaps_files/figure-html/max_frame_gap_5-1.png" width="700"></p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co">## How many trajectories do we end up with?</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">motive_mfg5</span><span class="op">$</span><span class="va">file_sub_traj</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 13</span></span></code></pre></div>
<p>By increasing the allowable frame gap, more chunks of data have been linked into trajectories and so our trajectory count has dropped from 335 to 224. Because it is hard to see all the trajectories piled up on top of each other, let’s go ahead and run this through <code><a href="../reference/get_full_trajectories.html">get_full_trajectories()</a></code> to clean out bits of data that do not span our region of interest. To inspect each trajectory individually, we can then use the <code><a href="../reference/plot_viewr_trajectories.html">plot_viewr_trajectories()</a></code> function to take a closer look at the quality of each trajectory. This can be computationally expensive depending on your data set.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">motive_mfg5_full</span> <span class="op">&lt;-</span> </span>
<span>  <span class="va">motive_mfg5</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="../reference/get_full_trajectories.html">get_full_trajectories</a></span><span class="op">(</span></span>
<span>    span <span class="op">=</span> <span class="fl">.6</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="co">## Quick plot</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">motive_mfg5_full</span><span class="op">$</span><span class="va">position_length</span>,</span>
<span>     <span class="va">motive_mfg5_full</span><span class="op">$</span><span class="va">position_width</span>,</span>
<span>     asp <span class="op">=</span> <span class="fl">1</span>, col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">motive_mfg5_full</span><span class="op">$</span><span class="va">file_sub_traj</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="managing-frame-gaps_files/figure-html/get_full_trajectories-1.png" width="700"></p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co">## How many trajectories do we end up with?</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">motive_mfg5_full</span><span class="op">$</span><span class="va">file_sub_traj</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 10</span></span>
<span></span>
<span><span class="co">## Plot each trajectory</span></span>
<span><span class="fu"><a href="../reference/plot_viewr_trajectories.html">plot_viewr_trajectories</a></span><span class="op">(</span><span class="va">motive_mfg5_full</span>,</span>
<span>                        plot_axes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"length"</span>, <span class="st">"width"</span><span class="op">)</span>,</span>
<span>                        multi_plot <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="managing-frame-gaps_files/figure-html/get_full_trajectories-2.png" width="700"></p>
</div>
<div class="section level3">
<h3 id="visualize-frame-gap-choice">Visualize frame gap choice<a class="anchor" aria-label="anchor" href="#visualize-frame-gap-choice"></a>
</h3>
<p><code>pathviewr</code> has several tools to help users decide what frame gap allowances may be appropriate depending on their data and resolution needs. <code><a href="../reference/visualize_frame_gap_choice.html">visualize_frame_gap_choice()</a></code> runs the <code><a href="../reference/separate_trajectories.html">separate_trajectories()</a></code> function over the same data set as many times as the user would like via the <code>loop</code> argument, each time with a different <code>max_frame_gap</code> allowance. Each loop represents an increase in the max frame gap value of 1. For example the default of <code>loops = 20</code> will run <code><a href="../reference/separate_trajectories.html">separate_trajectories()</a></code> over the data set 20 times, with an increase in the <code>max_frame_gap</code> argument of 1 each time.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">motive_cleaned</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="../reference/visualize_frame_gap_choice.html">visualize_frame_gap_choice</a></span><span class="op">(</span></span>
<span>    loops <span class="op">=</span> <span class="fl">20</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p><img src="managing-frame-gaps_files/figure-html/visualize_frame_gap_choice-1.png" width="700"></p>
<pre><code><span><span class="co">#&gt; [[1]]</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 20 × 3</span></span></span>
<span><span class="co">#&gt;    frame_gap_allowed trajectory_count file_id</span></span>
<span><span class="co">#&gt;                <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>            <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span>                 1               14 .      </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span>                 2               11 .      </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span>                 3               11 .      </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span>                 4               11 .      </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span>                 5               11 .      </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span>                 6               11 .      </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span>                 7               11 .      </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span>                 8               11 .      </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span>                 9               11 .      </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span>                10               11 .      </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">11</span>                11               11 .      </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">12</span>                12               11 .      </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">13</span>                13               11 .      </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">14</span>                14               11 .      </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">15</span>                15               11 .      </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">16</span>                16               11 .      </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">17</span>                17               11 .      </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">18</span>                18               11 .      </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">19</span>                19               11 .      </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">20</span>                20               11 .      </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[2]]</span></span>
<span><span class="co">#&gt; NULL</span></span></code></pre>
<p>The output of <code><a href="../reference/visualize_frame_gap_choice.html">visualize_frame_gap_choice()</a></code> is a tibble and plot of the number of trajectories after running <code><a href="../reference/separate_trajectories.html">separate_trajectories()</a></code> with <code>max_frame_gap = 1</code>, <code>max_frame_gap = 2</code>, <code>max_frame_gap = 3</code>, etc. We can see that as the frame gap allowance increases, more bits of data are being linked into continuous trajectories and thus the total number of trajectories decreases. The vertical line on the plot indicates the “elbow” of the plot or the point at which counts of trajectories appear to stabilize and increases in the <code>max_frame_gap</code> allowance no longer effect the trajectory count very much.</p>
</div>
<div class="section level3">
<h3 id="autodetect">Autodetect<a class="anchor" aria-label="anchor" href="#autodetect"></a>
</h3>
<p>Setting <code>max_frame_gap = "autodetect"</code> rather than a numeric value uses the “elbow” of the plots from <code><a href="../reference/visualize_frame_gap_choice.html">visualize_frame_gap_choice()</a></code> to guesstimate the best value(s) for <code>max_frame_gap</code>.</p>
<p><strong>In addition to automatically selecting the <code>max_frame_gap</code> depending on the data, <code>autodetect</code> does so on a per subject basis rather than applying the same allowable frame gap to all data in the data set since frame gaps can vary between subjects.</strong></p>
<p>The cap on how high the <code>max_frame_gap</code> can go is defined as a proportion of the capture frame rate and set by the <code>frame_rate_proportion</code> argument, which defaults to <code>.10</code>.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">motive_auto</span> <span class="op">&lt;-</span> </span>
<span>  <span class="va">motive_cleaned</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="../reference/separate_trajectories.html">separate_trajectories</a></span><span class="op">(</span></span>
<span>    max_frame_gap <span class="op">=</span> <span class="st">"autodetect"</span>,</span>
<span>    frame_rate_proportion <span class="op">=</span> <span class="fl">0.1</span>,</span>
<span>    frame_gap_messaging <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    frame_gap_plotting <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>  <span class="op">)</span></span>
<span><span class="co">#&gt; autodetect is an experimental feature -- please report issues.</span></span>
<span><span class="co">#&gt; For subject: device02, estimated best value for max_frame_gap: 1</span></span>
<span><span class="co">#&gt; For subject: device03, estimated best value for max_frame_gap: 2</span></span></code></pre></div>
<p><img src="managing-frame-gaps_files/figure-html/max_frame_gap_auto-1.png" width="700"></p>
<pre><code><span><span class="co">#&gt; For subject: device05, estimated best value for max_frame_gap: 2</span></span></code></pre>
<p><img src="managing-frame-gaps_files/figure-html/max_frame_gap_auto-2.png" width="700"><img src="managing-frame-gaps_files/figure-html/max_frame_gap_auto-3.png" width="700"></p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co">## How many trajectories do we end up with?</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">motive_auto</span><span class="op">$</span><span class="va">file_sub_traj</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 13</span></span></code></pre></div>
<p>Our sample data has 3 subjects so with <code>frame_gap_messaging = TRUE</code>, the <code>max_frame_gap</code> for each subject will be reported (the default is <code>FALSE</code>). <code>frame_gap_plotting = TRUE</code> will display the elbow plots for each subject, but also defaults to <code>FALSE</code>.</p>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><!-- begin footer --><div class="footer">
    <div class="container">
        <div class="row start top-4 bottom-8">
            <div class="col-2"> <img id="footerlogo" src="https://ropensci.org/img/icon_short_white.svg">
</div>
            <div class="col-10">
                <div class="row">
                    <div class="col-md-4 col-xs-6">
                        <a href="https://github.com/ropensci" target="_blank" class="external-link"><div class="icon fab fa-github"></div></a>
                        <a href="https://github.com/ropenscilabs" target="_blank" class="external-link"><div class="icon fa fa-flask"></div></a>
                        <a href="https://hachyderm.io/@ropensci" target="_blank" class="external-link"><div class="icon fab fa-mastodon"></div></a>
                        <a href="https://vimeo.com/ropensci" target="_blank" class="external-link"><div class="icon fab fa-vimeo"></div></a>
                    </div>
                </div>
                <div class="row top-4">
                    <div class="col-md-2 col-sm-4">
                        <ul>
<h5 class="bottom-2">About</h5>
                            <li><a href="https://ropensci.org/about" class="external-link">About rOpenSci</a></li>
                            <li><a href="https://ropensci.org/software-review" class="external-link">Software Review</a></li>
                            <li><a href="https://ropensci.org/about#team" class="external-link">Our Team</a></li>
                            <li><a href="https://ropensci.org/careers" class="external-link">Jobs</a></li>
                            <li><a href="https://ropensci.org/donate" class="external-link">Donate</a></li>
                            <li><a href="https://ropensci.org/contact" class="external-link">Contact Us</a></li>
                        </ul>
</div>
                    <div class="col-md-3 col-sm-4">
                        <ul>
<h5 class="bottom-2">Community</h5>
                            <li><a href="https://ropensci.org/community/" class="external-link">Our Community</a></li>
                            <li><a href="https://ropensci.org/commcalls/" class="external-link">Community calls</a></li>
                            <li><a href="https://ropensci.org/events/" class="external-link">Events</a></li>
                            <li><a href="https://discuss.ropensci.org/" class="external-link">Join the Discussion</a></li>
                            <li><a href="https://ropensci.org/code-of-conduct" class="external-link">Code of conduct</a></li>
                        </ul>
</div>
                    <div class="col-md-2 col-sm-4">
                        <ul>
<h5 class="bottom-2">Resources</h5>
                            <li><a href="https://ropensci.org/packages/" class="external-link">Packages</a></li>
                            <li><a href="https://ropensci.org/usecases/" class="external-link">Use Cases</a></li>
                            <li><a href="https://ropensci.org/talks-papers/" class="external-link">Talks &amp; Publications</a></li>
                            <li><a href="https://docs.ropensci.org/" class="external-link">Documentation</a></li>
                            <li><a href="https://ropensci.org/news/" class="external-link">Newsletter</a></li>
                            <li><a href="https://ropensci.org/how-to-cite-ropensci/" class="external-link">Cite rOpenSci</a></li>
                        </ul>
</div>
                    <div class="col-md-4 col-xs-12">
                        <h5 class="bottom-2"></h5>

                        <p>rOpenSci is a fiscally sponsored project of <a href="http://numfocus.org" class="external-link">NumFOCUS</a>.</p>

                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<!-- / end footer -->


    </footer>
</div>

  

  

  </body>
</html>
